# Black-Scholes Neural Network Makefile
# This Makefile provides targets for setup, training, and prediction with Luminair

.PHONY: help setup train predict clean build

# Default target
help:
	@echo "Available targets:"
	@echo "  setup   - Install Python dependencies and create environment"
	@echo "  train   - Train the PyTorch model and export weights"
	@echo "  predict - Run predictions with the Rust/Luminair model"
	@echo "  build   - Build the Rust executable"
	@echo "  clean   - Clean generated files and cache"

# Setup target: Install dependencies
setup:
	@echo "ğŸ”§ Setting up environment..."
	pip install -e .
	@echo "ğŸ“¦ Installing development dependencies..."
	pip install -e ".[dev]"
	@echo "ğŸ“ Creating weights directory..."
	mkdir -p weights
	@echo "âœ… Setup complete!"

# Training target: Train the model and export weights
train:
	@echo "ğŸš€ Starting training..."
	cd model && python main.py --config config.json
	@echo "âœ… Training complete!"

# Build Rust executable
build:
	@echo "ğŸ”¨ Building Rust executable..."
	cargo build --release
	@echo "âœ… Build complete!"

# Run predictions with Rust/Luminair
predict: build
	@echo "ğŸ”® Running predictions with Rust/Luminair model..."
	cargo run --release
	@echo "âœ… Prediction complete!"

# Clean target: Remove generated files
clean:
	@echo "ğŸ§¹ Cleaning up..."
	rm -rf target/
	rm -rf weights/
	rm -f model.pth
	rm -rf __pycache__/
	rm -rf model/__pycache__/
	rm -rf *.egg-info/
	rm -rf build/
	rm -rf dist/
	find . -name "*.pyc" -delete
	find . -name ".DS_Store" -delete
	@echo "âœ… Cleanup complete!"

# Full workflow: setup, train, and predict
all: setup train predict
	@echo "âœ… Full workflow complete!"